!function(e){"use strict";function n(){}function r(e){return function(){return e}}function t(){return j}function o(e){return e.isNone()}function i(e){return e()}function u(e){return e}function c(e){return function(n){return function(e){if(null===e)return"null";var n=typeof e;return"object"==n&&(Array.prototype.isPrototypeOf(e)||e.constructor&&"Array"===e.constructor.name)?"array":"object"==n&&(String.prototype.isPrototypeOf(e)||e.constructor&&"String"===e.constructor.name)?"string":n}(n)===e}}function s(e,n){for(var r=e.length,t=new Array(r),o=0;o<r;o++){var i=e[o];t[o]=n(i,o)}return t}function a(e,n){for(var r=0,t=e.length;r<t;r++)n(e[r],r)}function f(e,n){for(var r=[],t=0,o=e.length;t<o;t++){var i=e[t];n(i,t)&&r.push(i)}return r}function l(e,n){return function(e){for(var n=[],r=0,t=e.length;r<t;++r){if(!X(e[r]))throw new Error("Arr.flatten item "+r+" was not an array, input: "+e);K.apply(n,e[r])}return n}(s(e,n))}function d(e,n){return-1!==e.indexOf(n)}function m(e){return void 0!==e.style&&G(e.style.getPropertyValue)}function v(n,r,t){!function(n,r,t){if(!(z(t)||Y(t)||$(t)))throw e.console.error("Invalid call to Attr.set. Key ",r,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(r,t+"")}(n.dom(),r,t)}function h(e,n){var r=e.dom().getAttribute(n);return null===r?void 0:r}function g(e,n){e.dom().removeAttribute(n)}function p(n,r){var t=n.dom();!function(e,n){for(var r=J(e),t=0,o=r.length;t<o;t++){var i=r[t];n(e[i],i)}}(r,(function(n,r){!function(n,r,t){if(!z(t))throw e.console.error("Invalid call to CSS.set. Property ",r,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);m(n)&&n.style.setProperty(r,t)}(t,r,n)}))}function w(n,r){var t=n.dom(),o=e.window.getComputedStyle(t).getPropertyValue(r),i=""!==o||function(e){var n=te(e)?e.dom().parentNode:e.dom();return null!=n&&n.ownerDocument.body.contains(n)}(n)?o:oe(t,r);return null===i?void 0:i}function y(e,n){function r(e){return Number(n.replace(t,"$"+e))}var t=function(e,n){for(var r=0;r<e.length;r++){var t=e[r];if(t.test(n))return t}}(e,n);return t?ue(r(1),r(2)):{major:0,minor:0}}function S(e,n){return function(){return n===e}}function E(e,n){return function(){return n===e}}function O(e,n){var r=String(n).toLowerCase();return function(e,n){for(var r=0,t=e.length;r<t;r++){var o=e[r];if(n(o,r))return q.some(o)}return q.none()}(e,(function(e){return e.search(r)}))}function x(e){return function(n){return d(n,e)}}function N(){return xe.get()}function T(e,n){var r=e.dom();if(r.nodeType!==Ne)return!1;var t=r;if(void 0!==t.matches)return t.matches(n);if(void 0!==t.msMatchesSelector)return t.msMatchesSelector(n);if(void 0!==t.webkitMatchesSelector)return t.webkitMatchesSelector(n);if(void 0!==t.mozMatchesSelector)return t.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")}function b(n,r){var t=void 0===r?e.document:r.dom();return function(e){return e.nodeType!==Ne&&e.nodeType!==Te||0===e.childElementCount}(t)?[]:s(t.querySelectorAll(n),Z.fromDom)}function C(e){return function(e){return q.from(e.dom().parentNode).map(Z.fromDom)}(e).map(be).map((function(n){return f(n,(function(n){return!function(e,n){return e.dom()===n.dom()}(e,n)}))})).getOr([])}function A(e,n,t,o){return{x:r(e),y:r(n),width:r(t),height:r(o),right:r(e+t),bottom:r(n+o)}}function D(n){var r=void 0===n?e.window:n,t=r.document,o=function(n){var r=void 0!==n?n.dom():e.document,t=r.body.scrollLeft||r.documentElement.scrollLeft,o=r.body.scrollTop||r.documentElement.scrollTop;return Ae(t,o)}(Z.fromDom(t)),i=r.visualViewport;if(void 0!==i)return A(Math.max(i.pageLeft,o.left()),Math.max(i.pageTop,o.top()),i.width,i.height);var u=t.documentElement,c=u.clientWidth,s=u.clientHeight;return A(o.left(),o.top(),c,s)}function M(e,n,r){return f(function(e,n){for(var r=G(n)?n:U,t=e.dom(),o=[];null!==t.parentNode&&void 0!==t.parentNode;){var i=t.parentNode,u=Z.fromDom(i);if(o.push(u),!0===r(u))break;t=i}return o}(e,r),n)}function k(e,n){return function(e,n){return f(C(e),n)}(e,(function(e){return T(e,n)}))}function F(e,n){return function(r){function t(e){return r.setActive(e.state)}return r.setActive(null!==n.get()),e.on("FullscreenStateChanged",t),function(){return e.off("FullscreenStateChanged",t)}}}var _,R,L,P,I=function(e){function n(){return r}var r=e;return{get:n,set:function(e){r=e},clone:function(){return I(n())}}},H=tinymce.util.Tools.resolve("tinymce.PluginManager"),W=function(e){return{isFullscreen:function(){return null!==e.get()}}},U=r(!1),V=r(!0),j=(_={fold:function(e){return e()},is:U,isSome:U,isNone:V,getOr:u,getOrThunk:i,getOrDie:function(e){throw new Error(e||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:u,orThunk:i,map:t,each:n,bind:t,exists:U,forall:V,filter:t,equals:o,equals_:o,toArray:function(){return[]},toString:r("none()")},Object.freeze&&Object.freeze(_),_),B=function(e){function n(){return i}function t(n){return n(e)}var o=r(e),i={fold:function(n,r){return r(e)},is:function(n){return e===n},isSome:V,isNone:U,getOr:o,getOrThunk:o,getOrDie:o,getOrNull:o,getOrUndefined:o,or:n,orThunk:n,map:function(n){return B(n(e))},each:function(n){n(e)},bind:t,exists:t,forall:t,filter:function(n){return n(e)?i:j},toArray:function(){return[e]},toString:function(){return"some("+e+")"},equals:function(n){return n.is(e)},equals_:function(n,r){return n.fold(U,(function(n){return r(e,n)}))}};return i},q={some:B,none:t,from:function(e){return null==e?j:B(e)}},z=c("string"),X=c("array"),Y=c("boolean"),G=c("function"),$=c("number"),K=(Array.prototype.slice,Array.prototype.push),J=(G(Array.from)&&Array.from,Object.keys),Q=function(e){if(null==e)throw new Error("Node cannot be null or undefined");return{dom:r(e)}},Z={fromHtml:function(n,r){var t=(r||e.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw e.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return Q(t.childNodes[0])},fromTag:function(n,r){var t=(r||e.document).createElement(n);return Q(t)},fromText:function(n,r){var t=(r||e.document).createTextNode(n);return Q(t)},fromDom:Q,fromPoint:function(e,n,r){var t=e.dom();return q.from(t.elementFromPoint(n,r)).map(Q)}},ee=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE),ne=(e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),re=e.Node.TEXT_NODE,te=(e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,void 0!==e.window?e.window:Function("return this;")(),R=re,function(e){return function(e){return e.dom().nodeType}(e)===R}),oe=function(e,n){return m(e)?e.style.getPropertyValue(n):""},ie=function(){return ue(0,0)},ue=function(e,n){return{major:e,minor:n}},ce={nu:ue,detect:function(e,n){var r=String(n).toLowerCase();return 0===e.length?ie():y(e,r)},unknown:ie},se="Firefox",ae=function(e){var n=e.current;return{current:n,version:e.version,isEdge:S("Edge",n),isChrome:S("Chrome",n),isIE:S("IE",n),isOpera:S("Opera",n),isFirefox:S(se,n),isSafari:S("Safari",n)}},fe={unknown:function(){return ae({current:void 0,version:ce.unknown()})},nu:ae,edge:r("Edge"),chrome:r("Chrome"),ie:r("IE"),opera:r("Opera"),firefox:r(se),safari:r("Safari")},le="Windows",de="Android",me="Solaris",ve="FreeBSD",he=function(e){var n=e.current;return{current:n,version:e.version,isWindows:E(le,n),isiOS:E("iOS",n),isAndroid:E(de,n),isOSX:E("OSX",n),isLinux:E("Linux",n),isSolaris:E(me,n),isFreeBSD:E(ve,n)}},ge={unknown:function(){return he({current:void 0,version:ce.unknown()})},nu:he,windows:r(le),ios:r("iOS"),android:r(de),linux:r("Linux"),osx:r("OSX"),solaris:r(me),freebsd:r(ve)},pe=function(e,n){return O(e,n).map((function(e){var r=ce.detect(e.versionRegexes,n);return{current:e.name,version:r}}))},we=function(e,n){return O(e,n).map((function(e){var r=ce.detect(e.versionRegexes,n);return{current:e.name,version:r}}))},ye=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(e){return d(e,"edge/")&&d(e,"chrome")&&d(e,"safari")&&d(e,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ye],search:function(e){return d(e,"chrome")&&!d(e,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(e){return d(e,"msie")||d(e,"trident")}},{name:"Opera",versionRegexes:[ye,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:x("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:x("firefox")},{name:"Safari",versionRegexes:[ye,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(e){return(d(e,"safari")||d(e,"mobile/"))&&d(e,"applewebkit")}}],Ee=[{name:"Windows",search:x("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(e){return d(e,"iphone")||d(e,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:x("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:x("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:x("linux"),versionRegexes:[]},{name:"Solaris",search:x("sunos"),versionRegexes:[]},{name:"FreeBSD",search:x("freebsd"),versionRegexes:[]}],Oe={browsers:r(Se),oses:r(Ee)},xe=I(function(e,n){var t=Oe.browsers(),o=Oe.oses(),i=pe(t,e).fold(fe.unknown,fe.nu),u=we(o,e).fold(ge.unknown,ge.nu);return{browser:i,os:u,deviceType:function(e,n,t,o){var i=e.isiOS()&&!0===/ipad/i.test(t),u=e.isiOS()&&!i,c=e.isiOS()||e.isAndroid(),s=c||o("(pointer:coarse)"),a=i||!u&&c&&o("(min-device-width:768px)"),f=u||c&&!a,l=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(t),d=!f&&!a&&!l;return{isiPad:r(i),isiPhone:r(u),isTablet:r(a),isPhone:r(f),isTouch:r(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:r(l),isDesktop:r(d)}}(u,i,e,n)}}(e.navigator.userAgent,(function(n){return e.window.matchMedia(n).matches}))),Ne=ne,Te=ee,be=(N().browser.isIE(),function(e){return s(e.dom().childNodes,Z.fromDom)}),Ce=(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]}("element","offset"),function(e,n){return{left:r(e),top:r(n),translate:function(r,t){return Ce(e+r,n+t)}}}),Ae=Ce,De=(N().browser.isSafari(),function(e,n){e.fire("FullscreenStateChanged",{state:n})}),Me=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ke=tinymce.util.Tools.resolve("tinymce.Env"),Fe=tinymce.util.Tools.resolve("tinymce.util.Delay"),_e="data-ephox-mobile-fullscreen-style",Re="position:absolute!important;",Le="top:0!important;left:0!important;margin:0!important;padding:0!important;width:100%!important;height:100%!important;overflow:visible!important;",Pe=ke.os.isAndroid(),Ie=function(e,n){function r(e){return function(n){var r=h(n,"style"),t=void 0===r?"no-styles":r.trim();t!==e&&(v(n,_e,t),v(n,"style",e))}}var t=function(e,n){return M(e,(function(e){return T(e,n)}),void 0)}(e,"*"),o=l(t,(function(e){return k(e,"*:not(.tox-silver-sink)")})),i=function(e){var n=w(e,"background-color");return void 0!==n&&""!==n?"background-color:"+n+"!important":"background-color:rgb(255,255,255)!important;"}(n);a(o,r("display:none!important;")),a(t,r(Re+Le+i)),r((!0===Pe?"":Re)+Le+i)(e)},He=function(){a(function(e){return b(e)}("["+_e+"]"),(function(e){var n=h(e,_e);"no-styles"!==n?v(e,"style",n):g(e,"style"),g(e,_e)}))},We=Me.DOM,Ue=e.window.visualViewport,Ve=void 0===Ue?{bind:n,unbind:n}:(L=function(){var e=I(q.none());return{clear:function(){e.set(q.none())},set:function(n){e.set(q.some(n))},isSet:function(){return e.get().isSome()},on:function(n){e.get().each(n)}}}(),P=Fe.throttle((function(){e.document.body.scrollTop=0,e.document.documentElement.scrollTop=0,e.window.requestAnimationFrame((function(){L.on((function(e){return p(e,{top:Ue.offsetTop+"px",left:Ue.offsetLeft+"px",height:Ue.height+"px",width:Ue.width+"px"})}))}))}),50),{bind:function(e){L.set(e),P(),Ue.addEventListener("resize",P),Ue.addEventListener("scroll",P)},unbind:function(){L.on((function(){Ue.removeEventListener("scroll",P),Ue.removeEventListener("resize",P)})),L.clear()}}),je=function(n,r){var t,o,i,u=e.document.body,c=e.document.documentElement;o=n.getContainer();var s=Z.fromDom(o),a=r.get(),f=Z.fromDom(n.getBody()),l=ke.deviceType.isTouch();if(t=o.style,i=n.getContentAreaContainer().firstChild.style,a)i.width=a.iframeWidth,i.height=a.iframeHeight,t.width=a.containerWidth,t.height=a.containerHeight,t.top=a.containerTop,t.left=a.containerLeft,l&&He(),We.removeClass(u,"tox-fullscreen"),We.removeClass(c,"tox-fullscreen"),We.removeClass(o,"tox-fullscreen"),function(n){e.window.scrollTo(n.x,n.y)}(a.scrollPos),r.set(null),De(n,!1),Ve.unbind(),n.off("remove",Ve.unbind);else{var d={scrollPos:function(){var n=D(e.window);return{x:n.x(),y:n.y()}}(),containerWidth:t.width,containerHeight:t.height,containerTop:t.top,containerLeft:t.left,iframeWidth:i.width,iframeHeight:i.height};l&&Ie(s,f),i.width=i.height="100%",t.width=t.height="",We.addClass(u,"tox-fullscreen"),We.addClass(c,"tox-fullscreen"),We.addClass(o,"tox-fullscreen"),Ve.bind(s),n.on("remove",Ve.unbind),r.set(d),De(n,!0)}},Be=function(e,n){e.addCommand("mceFullScreen",(function(){je(e,n)}))},qe=function(e,n){e.ui.registry.addToggleMenuItem("fullscreen",{text:"Fullscreen",shortcut:"Meta+Shift+F",onAction:function(){return e.execCommand("mceFullScreen")},onSetup:F(e,n)}),e.ui.registry.addToggleButton("fullscreen",{tooltip:"Fullscreen",icon:"fullscreen",onAction:function(){return e.execCommand("mceFullScreen")},onSetup:F(e,n)})};H.add("fullscreen",(function(e){var n=I(null);return e.settings.inline||(Be(e,n),qe(e,n),e.addShortcut("Meta+Shift+F","","mceFullScreen")),W(n)}))}(window);